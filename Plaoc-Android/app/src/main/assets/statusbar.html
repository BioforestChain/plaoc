<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>System UI</title>
    <link rel="stylesheet" href="./pico.min.css" />
    <style>
      html {
        background: rgb(255 254 129 / 30%);
        border: 2px solid red;
      }
      body {
        margin-top: 50vh;
        margin-bottom: 50vh;
        background: transparent;
      }
      fieldset {
        background: rgb(0 0 0 / 60%);
        padding: 0.5em;
        border-radius: 0.5em;
        color: #ddd;
      }
      legend {
        font-size: 1.5em;
        font-weight: bold;
        background: rgb(0 0 0 / 60%);
        color: #fff;
        padding: 0.2em 1em;
        border-radius: 0.2em;
      }
      input {
        color: #eee;
      }
    </style>
  </head>
  <body>
    <main class="container">
      <fieldset>
        <legend>‰∫§‰∫íÊéßÂà∂</legend>
        <button id="disable_touch_event">Disable Touch Event</button>
        <script>
          disable_touch_event.onclick = () => {
            system_ui.disableTouchEvent();
            alert("‰ªéÁ≥ªÁªüÂ±ÇÈù¢Á¶ÅÁî®‰∫Ü touch-eventÔºåÁ±ª‰ººcssÁöÑpointer-event:none");
          };
        </script>
      </fieldset>
      <fieldset>
        <legend>TopBar</legend>
        <button id="toggle_topbar_enabled">Toggle TopBar Enabled</button>
        <script>
          toggle_topbar_enabled.onclick = () => {
            top_bar.toggleEnabled(0);
          };
        </script>
        <label>
          Ê†áÈ¢ò
          <input id="title_value" value="MY TOP BAR TITLEüë©üèæ‚Äçüç≥" />
          <button id="set_title">‰øÆÊîπ</button>
          <script>
            set_title.onclick = () => {
              top_bar.setTitle(title_value.value);
            };
          </script>
        </label>
        <button id="toggle_topbar_overlay">Toggle TopBar Overlay</button>
        <script>
          toggle_topbar_overlay.onclick = () => {
            top_bar.toggleOverlay(0);
          };
        </script>
        <button id="get_topbar_height">Get TopBar Height</button>
        <script>
          get_topbar_height.onclick = () => {
            alert(top_bar.getHeight());
          };
        </script>
        <label>
          Ëá™ÂÆö‰πâActions
          <span id="topbar_action_1"></span>
          <span id="topbar_action_2"></span>
          <input id="custom_topbar_actions" type="checkbox" role="switch" />
          <script>
            custom_topbar_actions.onchange = () => {
              if (custom_topbar_actions.checked) {
                top_bar.setActions(
                  JSON.stringify([
                    {
                      icon: { source: "Filled.AddCircle" },
                      onClickCode:
                        "topbar_action_1.innerHTML = 1+(parseInt(topbar_action_1.innerHTML)||0)",
                    },
                    {
                      icon: { source: "Filled.Add" },
                      onClickCode:
                        "topbar_action_2.innerHTML = Math.random().toString(36).substring(2)",
                    },
                    {
                      icon: {
                        source: new URL(
                          "./icon/coil_logo_colored.svg",
                          location.href
                        ).href,
                        type: "AssetIcon",
                      },
                      onClickCode: "topbar_action_2.innerHTML = '100%OK'",
                    },
                  ])
                );
              } else {
                top_bar.setActions(JSON.stringify([]));
              }
            };
          </script>
        </label>
        <button id="set_topbar_background_color">
          Set TopBar Background Color
        </button>
        <script>
          set_topbar_background_color.onclick = () => {
            top_bar.setBackgroundColor(getColorInt());
          };
        </script>
        <button id="set_topbar_foreground_color">
          Set TopBar Foreground Color
        </button>
        <script>
          set_topbar_foreground_color.onclick = () => {
            top_bar.setForegroundColor(getColorInt());
          };
        </script>
      </fieldset>

      <fieldset>
        <legend>BottomBar</legend>
        <button id="toggle_bottombar_enabled">Toggle BottomBar Enabled</button>
        <script>
          toggle_bottombar_enabled.onclick = () => {
            bottom_bar.toggleEnabled(0);
          };
        </script>
        <button id="toggle_bottombar_overlay">Toggle BottomBar Overlay</button>
        <script>
          toggle_bottombar_overlay.onclick = () => {
            bottom_bar.toggleOverlay(0);
          };
        </script>
        <button id="get_bottombar_height">Get BottomBar Height</button>
        <script>
          get_bottombar_height.onclick = () => {
            alert(bottom_bar.getHeight());
          };
        </script>
        <label>
          Ëá™ÂÆö‰πâActions
          <span id="bottombar_action_1"></span>
          <span id="bottombar_action_2"></span>
          <input id="custom_bottombar_actions" type="checkbox" role="switch" />
          <script>
            custom_bottombar_actions.onchange = () => {
              if (custom_bottombar_actions.checked) {
                bottom_bar.setActions(
                  JSON.stringify([
                    {
                      icon: { source: "Filled.AddCircle" },
                      onClickCode:
                        "bottombar_action_1.innerHTML = 1+(parseInt(bottombar_action_1.innerHTML)||0)",
                      label: "add",
                      selected: true,
                      colors: {
                        textColor: 0xffaa0000,
                        textColorSelected: 0xaa00ff00,
                        iconColor: 0xffaa0000,
                        iconColorSelected: 0xaa00ff00,
                      },
                    },
                    {
                      icon: {
                        source: new URL(
                          "./icon/ico_bottom_tab_publisher.svg",
                          location.href
                        ).href,
                        type: "AssetIcon",
                        size: 50,
                      },
                      selectable: false,
                      onClickCode: "bottombar_action_2.innerHTML = '100%OK'",
                    },
                    {
                      icon: { source: "Filled.Add" },
                      onClickCode:
                        "bottombar_action_2.innerHTML = Math.random().toString(36).substring(2)",
                      label: "add",
                      colors: {
                        indicatorColor: 0xdd0000ff,
                      },
                    },
                  ])
                );
              } else {
                bottom_bar.setActions(JSON.stringify([]));
              }
            };
          </script>
        </label>
        <input
          id="set_bottombar_height"
          type="range"
          min="0"
          max="100"
          value="50"
          step="1"
        />
        <script>
          let defaultHeight = 0;
          set_bottombar_height.oninput = () => {
            if (defaultHeight === 0) {
              defaultHeight = bottom_bar.getHeight();
            }
            if (defaultHeight !== 0) {
              bottom_bar.setHeight(
                defaultHeight + set_bottombar_height.valueAsNumber - 50
              );
            }
          };
        </script>
        <button id="set_bottombar_background_color">
          Set BottomBar Background Color
        </button>
        <script>
          set_bottombar_background_color.onclick = () => {
            bottom_bar.setBackgroundColor(getColorInt());
          };
        </script>
        <button id="set_bottombar_foreground_color">
          Set BottomBar Foreground Color
        </button>
        <script>
          set_bottombar_foreground_color.onclick = () => {
            bottom_bar.setForegroundColor(getColorInt());
          };
        </script>
      </fieldset>
      <fieldset>
        <legend>È¢úËâ≤ÈÄâÊã©</legend>

        <label for="color_rgb">
          È¢úËâ≤
          <input type="color" id="color_rgb" />
        </label>
        <label for="color_a">
          ÈÄèÊòéÂ∫¶
          <input type="range" id="color_a" min="0" max="1" step="0.1" />
        </label>
        <script>
          function getColorInt() {
            return (
              parseInt(color_rgb.value.slice(1), 16) +
              (parseInt(color_a.valueAsNumber * 255) << (8 * 3))
            );
          }
        </script>
        <label for="dark_icons">
          ÂõæÊ†áÈ¢úËâ≤
          <select id="dark_icons">
            <option value="0">ÈªòËÆ§(color.luminance>0.5)</option>
            <option value="1">ÈªëËâ≤(dark)</option>
            <option value="-1">ÁôΩËâ≤(light)</option>
          </select>
        </label>
        <script>
          function getIsDarkIcons() {
            return Function(`return ${dark_icons.value}`)();
          }
        </script>
      </fieldset>
      <fieldset>
        <legend>Status Bar</legend>
        <button id="set_statusbar_color">Set Status Bar Color</button>
        <script>
          set_statusbar_color.onclick = () => {
            system_ui.setStatusBarColor(getColorInt(), getIsDarkIcons());
          };
        </script>
        <button id="toggle_statusbar_visible">Toggle Status Bar Visible</button>
        <script>
          toggle_statusbar_visible.onclick = () => {
            system_ui.toggleStatusBarVisible(0);
          };
        </script>
        <button id="toggle_statusbar_overlay">Toggle Status Bar Overlay</button>
        <script>
          toggle_statusbar_overlay.onclick = () => {
            system_ui.toggleStatusBarOverlay(0);
          };
        </script>
      </fieldset>
      <fieldset>
        <legend>Navigation Bar</legend>
        <button id="set_navigationbar_color">Set Navigation Bar Color</button>
        <script>
          set_navigationbar_color.onclick = () => {
            system_ui.setNavigationBarColor(getColorInt(), getIsDarkIcons(), 0);
          };
        </script>
        <button id="toggle_navigationbar_visible">
          Toggle Navigation Bar Visible
        </button>
        <script>
          toggle_navigationbar_visible.onclick = () => {
            system_ui.toggleNavigationBarVisible(0);
          };
        </script>
        <button id="toggle_navigationbar_overlay">
          Toggle Navigation Bar Overlay
        </button>
        <script>
          toggle_navigationbar_overlay.onclick = () => {
            system_ui.toggleNavigationBarOverlay(0);
          };
        </script>
      </fieldset>

      <fieldset>
        <legend>insets</legend>

        <label for="insets_type">
          ÈÄâÊã©Á±ªÂûã
          <select id="insets_type"></select>
        </label>

        <script>
          const INSETS_TYPE = {
            STATUS_BARS: 1,
            NAVIGATION_BARS: 1 << 1,
            CAPTION_BAR: 1 << 2,

            IME: 1 << 3,

            SYSTEM_GESTURES: 1 << 4,
            MANDATORY_SYSTEM_GESTURES: 1 << 5,
            TAPPABLE_ELEMENT: 1 << 6,

            DISPLAY_CUTOUT: 1 << 7,

            WINDOW_DECOR: 1 << 8,
          };
          for (const key in INSETS_TYPE) {
            const option = document.createElement("option");
            option.value = INSETS_TYPE[key];
            option.innerHTML = key;
            insets_type.appendChild(option);
          }
        </script>
        <label for="ignore_inserts_visibility">
          ÂøΩÁï•‰∏çÂèØËßÅ
          <input type="checkbox" id="ignore_inserts_visibility" role="switch" />
        </label>

        <button id="get_insets_size">Get Insets Size</button>
        <script>
          get_insets_size.onclick = () => {
            alert(
              system_ui.getInsetsRect(
                insets_type.value | 0,
                ignore_inserts_visibility.checked ? 1 : 0
              )
            );
          };
        </script>
        <button id="show_insets">Show Insets</button>
        <script>
          show_insets.onclick = () => {
            system_ui.showInsets(insets_type.value | 0);
          };
        </script>
      </fieldset>
      <fieldset>
        <legend>IME</legend>
        <button id="toggle_ime_overlay">Toggle IME Overlay</button>
        <script>
          toggle_ime_overlay.onclick = () => {
            input_method_eidtor.toggleOverlay(0);
          };
        </script>
        <input id="ime" placeholder="IME Test" />
        <style>
          #ime {
            transform: translateY(
              calc(-1 * var(--virtual-keyboard-safe-area-bottom))
            );
          }
        </style>
        <script>
          {
            let isFocus = false;
            ime.onfocus = () => {
              isFocus = true;
              const setValue = () => {
                try {
                  ime.value =
                    __android_util_js__.virtualKeyboardSafeArea.bottom;
                } catch (e) {}
                if (isFocus) {
                  requestAnimationFrame(setValue);
                }
              };
              setValue();
            };
            ime.onblur = () => {
              isFocus = false;
            };
          }
        </script>
        <button id="get_ime_safe_area">Get IME Safe Area</button>
        <script>
          get_ime_safe_area.onclick = () => {
            alert(input_method_eidtor.getSafeArea());
          };
        </script>
        <button id="get_ime_height">Get IME Height</button>
        <script>
          get_ime_height.onclick = () => {
            alert(input_method_eidtor.getHeight());
          };
        </script>
      </fieldset>
      <fieldset>
        <legend>Dialog</legend>
        <input id="message" value="Hello Dialog" />
        <button id="show_alert_dialog">Show Alert Dialog</button>
        <script>
          show_alert_dialog.onclick = () => alert(message.value);
        </script>
        <button id="show_native_alert_dialog">Show Native Alert Dialog</button>
        <script>
          show_native_alert_dialog.onclick = () => {
            native_dialog.openAlert(
              JSON.stringify({
                title: "Ëá™ÂÆö‰πâÊ†áÈ¢ò",
                content: "ÂÜÖÂÆπ",
                confirmText: "Â•ΩÂêß",
              }),
              "show_native_alert_dialog.callback"
            );
          };

          show_native_alert_dialog.callback = () => {
            const BASE_TEXT = "Show Native Alert Dialog ";
            show_native_alert_dialog.times =
              1 + (show_native_alert_dialog.times | 0);
            show_native_alert_dialog.innerHTML =
              BASE_TEXT + " " + show_native_alert_dialog.times;
          };
        </script>

        <input id="prompt_value" value="Default Value From JS" />
        <button id="show_prompt_dialog">Show Prompt Dialog</button>
        <script>
          show_prompt_dialog.onclick = () => {
            prompt_value.value = prompt(message.value, prompt_value.value);
          };
        </script>

        <button id="show_confirm_dialog">
          Show Confirm Dialog
          <input id="confirm_value" type="checkbox" role="switch" />
        </button>
        <script>
          show_confirm_dialog.onclick = () => {
            confirm_value.checked = confirm(message.value);
          };
        </script>
        <label for="toggle_before_unload">Ê≥®ÂÜå Before Unload</label>
        <input id="toggle_before_unload" type="checkbox" role="switch" />
        <script>
          toggle_before_unload.onchange = () => {
            if (toggle_before_unload.checked) {
              window.onbeforeunload = (e) => {
                var dialogText = message.value;
                e.returnValue = dialogText;
                return dialogText;
              };
            } else {
              window.onbeforeunload = null;
            }
          };
        </script>
        <button id="reload_page">Reload Page</button>
        <script>
          reload_page.onclick = () => {
            location.search = `?title=${encodeURIComponent(message.value)}`;
          };
          const customTitle = new URLSearchParams(location.search).get("title");
          if (customTitle) {
            document.title = customTitle;
          }
        </script>
      </fieldset>
    </main>
  </body>
</html>
